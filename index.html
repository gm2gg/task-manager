<!DOCTYPE html>
<html>
<head>
    <title>Задачник</title>
</head>
<body>
    <h1>Мой задачник</h1>

    <input type="text" id="taskInput" placeholder="Введите задачу">
    <button onclick="addTask()">Добавить задачу</button>

    <div id="taskList"></div>

    <script>
    // Функция для ЗАГРУЗКИ задач при открытии страницы
function loadTasks() {
    fetch('http://localhost:5000/get_tasks?user_id=123')
        .then(response => response.json())
        .then(tasks => {
            const taskList = document.getElementById('taskList');
            taskList.innerHTML = ''; // Очищаем список
            
            tasks.forEach(task => {
                const taskElement = document.createElement('div');
                taskElement.textContent = task[2]; // title находится в третьем столбце
                taskList.appendChild(taskElement);
            });
        })
        .catch(error => {
            console.error('Ошибка загрузки задач:', error);
        });
}

// Загружаем задачи при загрузке страницы
document.addEventListener('DOMContentLoaded', loadTasks);
    function addTask() {
        const taskText = document.getElementById('taskInput').value;
        if (taskText.trim() === '') return;
    
        // 1. Добавляем задачу на страницу
        const taskList = document.getElementById('taskList');
        const newTask = document.createElement('div');
        newTask.textContent = taskText;
        taskList.appendChild(newTask);

        // 2. ОТПРАВЛЯЕМ НА СЕРВЕР
        fetch('http://localhost:5000/save_task', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                user_id: 123,  // Пока заглушка, потом разберешься как получить реальный ID
                title: taskText
            })
        })
        .then(response => response.json())
        .then(data => {
            console.log('Задача сохранена:', data);
        })
        .catch(error => {
            console.error('Ошибка:', error);
        });
    
        // 3. Очищаем поле ввода
        document.getElementById('taskInput').value = '';
    }
    </script>
</body>
</html>


